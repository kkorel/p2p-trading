"use strict";
/**
 * Time Window Utilities
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.timeWindowsOverlap = timeWindowsOverlap;
exports.calculateOverlapDuration = calculateOverlapDuration;
exports.getTimeWindowDuration = getTimeWindowDuration;
exports.calculateTimeWindowFit = calculateTimeWindowFit;
/**
 * Check if two time windows overlap
 * Returns true if either window is undefined (no filtering)
 */
function timeWindowsOverlap(a, b) {
    // If either window is undefined, treat as "always matches"
    if (!a || !b) {
        return true;
    }
    if (!a.startTime || !a.endTime || !b.startTime || !b.endTime) {
        return true;
    }
    const aStart = new Date(a.startTime).getTime();
    const aEnd = new Date(a.endTime).getTime();
    const bStart = new Date(b.startTime).getTime();
    const bEnd = new Date(b.endTime).getTime();
    return aStart < bEnd && bStart < aEnd;
}
/**
 * Calculate the overlap duration in milliseconds
 */
function calculateOverlapDuration(a, b) {
    // If either window is undefined, return 0 (no overlap to calculate)
    if (!a || !b)
        return 0;
    if (!a.startTime || !a.endTime || !b.startTime || !b.endTime)
        return 0;
    const aStart = new Date(a.startTime).getTime();
    const aEnd = new Date(a.endTime).getTime();
    const bStart = new Date(b.startTime).getTime();
    const bEnd = new Date(b.endTime).getTime();
    const overlapStart = Math.max(aStart, bStart);
    const overlapEnd = Math.min(aEnd, bEnd);
    return Math.max(0, overlapEnd - overlapStart);
}
/**
 * Calculate time window duration in milliseconds
 */
function getTimeWindowDuration(tw) {
    if (!tw || !tw.startTime || !tw.endTime)
        return 0;
    return new Date(tw.endTime).getTime() - new Date(tw.startTime).getTime();
}
/**
 * Calculate time window fit ratio (0.0 to 1.0)
 */
function calculateTimeWindowFit(offer, requested) {
    if (!offer || !requested)
        return 1; // Perfect fit if no time constraints
    const overlapDuration = calculateOverlapDuration(offer, requested);
    const requestedDuration = getTimeWindowDuration(requested);
    if (requestedDuration === 0)
        return 1; // No duration requested = perfect fit
    return Math.min(1, overlapDuration / requestedDuration);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInRpbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQVFILGdEQWVDO0FBS0QsNERBY0M7QUFLRCxzREFHQztBQUtELHdEQVNDO0FBNUREOzs7R0FHRztBQUNILFNBQWdCLGtCQUFrQixDQUFDLENBQWMsRUFBRSxDQUFjO0lBQy9ELDJEQUEyRDtJQUMzRCxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDYixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFDRCxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzdELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELE1BQU0sTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUMvQyxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDM0MsTUFBTSxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQy9DLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUUzQyxPQUFPLE1BQU0sR0FBRyxJQUFJLElBQUksTUFBTSxHQUFHLElBQUksQ0FBQztBQUN4QyxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQix3QkFBd0IsQ0FBQyxDQUFjLEVBQUUsQ0FBYztJQUNyRSxvRUFBb0U7SUFDcEUsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7UUFBRSxPQUFPLENBQUMsQ0FBQztJQUN2QixJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU87UUFBRSxPQUFPLENBQUMsQ0FBQztJQUV2RSxNQUFNLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDL0MsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQzNDLE1BQU0sTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUMvQyxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFFM0MsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDOUMsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFFeEMsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxVQUFVLEdBQUcsWUFBWSxDQUFDLENBQUM7QUFDaEQsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IscUJBQXFCLENBQUMsRUFBZTtJQUNuRCxJQUFJLENBQUMsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPO1FBQUUsT0FBTyxDQUFDLENBQUM7SUFDbEQsT0FBTyxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQzNFLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLHNCQUFzQixDQUFDLEtBQWtCLEVBQUUsU0FBc0I7SUFDL0UsSUFBSSxDQUFDLEtBQUssSUFBSSxDQUFDLFNBQVM7UUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLHFDQUFxQztJQUV6RSxNQUFNLGVBQWUsR0FBRyx3QkFBd0IsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDbkUsTUFBTSxpQkFBaUIsR0FBRyxxQkFBcUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUUzRCxJQUFJLGlCQUFpQixLQUFLLENBQUM7UUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLHNDQUFzQztJQUU3RSxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLGVBQWUsR0FBRyxpQkFBaUIsQ0FBQyxDQUFDO0FBQzFELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRpbWUgV2luZG93IFV0aWxpdGllc1xuICovXG5cbmltcG9ydCB7IFRpbWVXaW5kb3cgfSBmcm9tICcuLi90eXBlcy9iZWNrbic7XG5cbi8qKlxuICogQ2hlY2sgaWYgdHdvIHRpbWUgd2luZG93cyBvdmVybGFwXG4gKiBSZXR1cm5zIHRydWUgaWYgZWl0aGVyIHdpbmRvdyBpcyB1bmRlZmluZWQgKG5vIGZpbHRlcmluZylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRpbWVXaW5kb3dzT3ZlcmxhcChhPzogVGltZVdpbmRvdywgYj86IFRpbWVXaW5kb3cpOiBib29sZWFuIHtcbiAgLy8gSWYgZWl0aGVyIHdpbmRvdyBpcyB1bmRlZmluZWQsIHRyZWF0IGFzIFwiYWx3YXlzIG1hdGNoZXNcIlxuICBpZiAoIWEgfHwgIWIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoIWEuc3RhcnRUaW1lIHx8ICFhLmVuZFRpbWUgfHwgIWIuc3RhcnRUaW1lIHx8ICFiLmVuZFRpbWUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBcbiAgY29uc3QgYVN0YXJ0ID0gbmV3IERhdGUoYS5zdGFydFRpbWUpLmdldFRpbWUoKTtcbiAgY29uc3QgYUVuZCA9IG5ldyBEYXRlKGEuZW5kVGltZSkuZ2V0VGltZSgpO1xuICBjb25zdCBiU3RhcnQgPSBuZXcgRGF0ZShiLnN0YXJ0VGltZSkuZ2V0VGltZSgpO1xuICBjb25zdCBiRW5kID0gbmV3IERhdGUoYi5lbmRUaW1lKS5nZXRUaW1lKCk7XG4gIFxuICByZXR1cm4gYVN0YXJ0IDwgYkVuZCAmJiBiU3RhcnQgPCBhRW5kO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgb3ZlcmxhcCBkdXJhdGlvbiBpbiBtaWxsaXNlY29uZHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZU92ZXJsYXBEdXJhdGlvbihhPzogVGltZVdpbmRvdywgYj86IFRpbWVXaW5kb3cpOiBudW1iZXIge1xuICAvLyBJZiBlaXRoZXIgd2luZG93IGlzIHVuZGVmaW5lZCwgcmV0dXJuIDAgKG5vIG92ZXJsYXAgdG8gY2FsY3VsYXRlKVxuICBpZiAoIWEgfHwgIWIpIHJldHVybiAwO1xuICBpZiAoIWEuc3RhcnRUaW1lIHx8ICFhLmVuZFRpbWUgfHwgIWIuc3RhcnRUaW1lIHx8ICFiLmVuZFRpbWUpIHJldHVybiAwO1xuICBcbiAgY29uc3QgYVN0YXJ0ID0gbmV3IERhdGUoYS5zdGFydFRpbWUpLmdldFRpbWUoKTtcbiAgY29uc3QgYUVuZCA9IG5ldyBEYXRlKGEuZW5kVGltZSkuZ2V0VGltZSgpO1xuICBjb25zdCBiU3RhcnQgPSBuZXcgRGF0ZShiLnN0YXJ0VGltZSkuZ2V0VGltZSgpO1xuICBjb25zdCBiRW5kID0gbmV3IERhdGUoYi5lbmRUaW1lKS5nZXRUaW1lKCk7XG4gIFxuICBjb25zdCBvdmVybGFwU3RhcnQgPSBNYXRoLm1heChhU3RhcnQsIGJTdGFydCk7XG4gIGNvbnN0IG92ZXJsYXBFbmQgPSBNYXRoLm1pbihhRW5kLCBiRW5kKTtcbiAgXG4gIHJldHVybiBNYXRoLm1heCgwLCBvdmVybGFwRW5kIC0gb3ZlcmxhcFN0YXJ0KTtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgdGltZSB3aW5kb3cgZHVyYXRpb24gaW4gbWlsbGlzZWNvbmRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaW1lV2luZG93RHVyYXRpb24odHc/OiBUaW1lV2luZG93KTogbnVtYmVyIHtcbiAgaWYgKCF0dyB8fCAhdHcuc3RhcnRUaW1lIHx8ICF0dy5lbmRUaW1lKSByZXR1cm4gMDtcbiAgcmV0dXJuIG5ldyBEYXRlKHR3LmVuZFRpbWUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKHR3LnN0YXJ0VGltZSkuZ2V0VGltZSgpO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSB0aW1lIHdpbmRvdyBmaXQgcmF0aW8gKDAuMCB0byAxLjApXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVUaW1lV2luZG93Rml0KG9mZmVyPzogVGltZVdpbmRvdywgcmVxdWVzdGVkPzogVGltZVdpbmRvdyk6IG51bWJlciB7XG4gIGlmICghb2ZmZXIgfHwgIXJlcXVlc3RlZCkgcmV0dXJuIDE7IC8vIFBlcmZlY3QgZml0IGlmIG5vIHRpbWUgY29uc3RyYWludHNcbiAgXG4gIGNvbnN0IG92ZXJsYXBEdXJhdGlvbiA9IGNhbGN1bGF0ZU92ZXJsYXBEdXJhdGlvbihvZmZlciwgcmVxdWVzdGVkKTtcbiAgY29uc3QgcmVxdWVzdGVkRHVyYXRpb24gPSBnZXRUaW1lV2luZG93RHVyYXRpb24ocmVxdWVzdGVkKTtcbiAgXG4gIGlmIChyZXF1ZXN0ZWREdXJhdGlvbiA9PT0gMCkgcmV0dXJuIDE7IC8vIE5vIGR1cmF0aW9uIHJlcXVlc3RlZCA9IHBlcmZlY3QgZml0XG4gIFxuICByZXR1cm4gTWF0aC5taW4oMSwgb3ZlcmxhcER1cmF0aW9uIC8gcmVxdWVzdGVkRHVyYXRpb24pO1xufVxuIl19