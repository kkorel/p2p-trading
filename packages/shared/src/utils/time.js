"use strict";
/**
 * Time Window Utilities
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.timeWindowsOverlap = timeWindowsOverlap;
exports.calculateOverlapDuration = calculateOverlapDuration;
exports.getTimeWindowDuration = getTimeWindowDuration;
exports.calculateTimeWindowFit = calculateTimeWindowFit;
/**
 * Check if two time windows overlap
 */
function timeWindowsOverlap(a, b) {
    const aStart = new Date(a.startTime).getTime();
    const aEnd = new Date(a.endTime).getTime();
    const bStart = new Date(b.startTime).getTime();
    const bEnd = new Date(b.endTime).getTime();
    return aStart < bEnd && bStart < aEnd;
}
/**
 * Calculate the overlap duration in milliseconds
 */
function calculateOverlapDuration(a, b) {
    const aStart = new Date(a.startTime).getTime();
    const aEnd = new Date(a.endTime).getTime();
    const bStart = new Date(b.startTime).getTime();
    const bEnd = new Date(b.endTime).getTime();
    const overlapStart = Math.max(aStart, bStart);
    const overlapEnd = Math.min(aEnd, bEnd);
    return Math.max(0, overlapEnd - overlapStart);
}
/**
 * Calculate time window duration in milliseconds
 */
function getTimeWindowDuration(tw) {
    return new Date(tw.endTime).getTime() - new Date(tw.startTime).getTime();
}
/**
 * Calculate time window fit ratio (0.0 to 1.0)
 */
function calculateTimeWindowFit(offer, requested) {
    const overlapDuration = calculateOverlapDuration(offer, requested);
    const requestedDuration = getTimeWindowDuration(requested);
    if (requestedDuration === 0)
        return 0;
    return Math.min(1, overlapDuration / requestedDuration);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInRpbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQU9ILGdEQU9DO0FBS0QsNERBVUM7QUFLRCxzREFFQztBQUtELHdEQU9DO0FBNUNEOztHQUVHO0FBQ0gsU0FBZ0Isa0JBQWtCLENBQUMsQ0FBYSxFQUFFLENBQWE7SUFDN0QsTUFBTSxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQy9DLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUMzQyxNQUFNLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDL0MsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBRTNDLE9BQU8sTUFBTSxHQUFHLElBQUksSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDO0FBQ3hDLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLHdCQUF3QixDQUFDLENBQWEsRUFBRSxDQUFhO0lBQ25FLE1BQU0sTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUMvQyxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDM0MsTUFBTSxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQy9DLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUUzQyxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztJQUM5QyxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUV4QyxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFVBQVUsR0FBRyxZQUFZLENBQUMsQ0FBQztBQUNoRCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixxQkFBcUIsQ0FBQyxFQUFjO0lBQ2xELE9BQU8sSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxHQUFHLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUMzRSxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixzQkFBc0IsQ0FBQyxLQUFpQixFQUFFLFNBQXFCO0lBQzdFLE1BQU0sZUFBZSxHQUFHLHdCQUF3QixDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNuRSxNQUFNLGlCQUFpQixHQUFHLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRTNELElBQUksaUJBQWlCLEtBQUssQ0FBQztRQUFFLE9BQU8sQ0FBQyxDQUFDO0lBRXRDLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsZUFBZSxHQUFHLGlCQUFpQixDQUFDLENBQUM7QUFDMUQsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGltZSBXaW5kb3cgVXRpbGl0aWVzXG4gKi9cblxuaW1wb3J0IHsgVGltZVdpbmRvdyB9IGZyb20gJy4uL3R5cGVzL2JlY2tuJztcblxuLyoqXG4gKiBDaGVjayBpZiB0d28gdGltZSB3aW5kb3dzIG92ZXJsYXBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRpbWVXaW5kb3dzT3ZlcmxhcChhOiBUaW1lV2luZG93LCBiOiBUaW1lV2luZG93KTogYm9vbGVhbiB7XG4gIGNvbnN0IGFTdGFydCA9IG5ldyBEYXRlKGEuc3RhcnRUaW1lKS5nZXRUaW1lKCk7XG4gIGNvbnN0IGFFbmQgPSBuZXcgRGF0ZShhLmVuZFRpbWUpLmdldFRpbWUoKTtcbiAgY29uc3QgYlN0YXJ0ID0gbmV3IERhdGUoYi5zdGFydFRpbWUpLmdldFRpbWUoKTtcbiAgY29uc3QgYkVuZCA9IG5ldyBEYXRlKGIuZW5kVGltZSkuZ2V0VGltZSgpO1xuICBcbiAgcmV0dXJuIGFTdGFydCA8IGJFbmQgJiYgYlN0YXJ0IDwgYUVuZDtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG92ZXJsYXAgZHVyYXRpb24gaW4gbWlsbGlzZWNvbmRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVPdmVybGFwRHVyYXRpb24oYTogVGltZVdpbmRvdywgYjogVGltZVdpbmRvdyk6IG51bWJlciB7XG4gIGNvbnN0IGFTdGFydCA9IG5ldyBEYXRlKGEuc3RhcnRUaW1lKS5nZXRUaW1lKCk7XG4gIGNvbnN0IGFFbmQgPSBuZXcgRGF0ZShhLmVuZFRpbWUpLmdldFRpbWUoKTtcbiAgY29uc3QgYlN0YXJ0ID0gbmV3IERhdGUoYi5zdGFydFRpbWUpLmdldFRpbWUoKTtcbiAgY29uc3QgYkVuZCA9IG5ldyBEYXRlKGIuZW5kVGltZSkuZ2V0VGltZSgpO1xuICBcbiAgY29uc3Qgb3ZlcmxhcFN0YXJ0ID0gTWF0aC5tYXgoYVN0YXJ0LCBiU3RhcnQpO1xuICBjb25zdCBvdmVybGFwRW5kID0gTWF0aC5taW4oYUVuZCwgYkVuZCk7XG4gIFxuICByZXR1cm4gTWF0aC5tYXgoMCwgb3ZlcmxhcEVuZCAtIG92ZXJsYXBTdGFydCk7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHRpbWUgd2luZG93IGR1cmF0aW9uIGluIG1pbGxpc2Vjb25kc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGltZVdpbmRvd0R1cmF0aW9uKHR3OiBUaW1lV2luZG93KTogbnVtYmVyIHtcbiAgcmV0dXJuIG5ldyBEYXRlKHR3LmVuZFRpbWUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKHR3LnN0YXJ0VGltZSkuZ2V0VGltZSgpO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSB0aW1lIHdpbmRvdyBmaXQgcmF0aW8gKDAuMCB0byAxLjApXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVUaW1lV2luZG93Rml0KG9mZmVyOiBUaW1lV2luZG93LCByZXF1ZXN0ZWQ6IFRpbWVXaW5kb3cpOiBudW1iZXIge1xuICBjb25zdCBvdmVybGFwRHVyYXRpb24gPSBjYWxjdWxhdGVPdmVybGFwRHVyYXRpb24ob2ZmZXIsIHJlcXVlc3RlZCk7XG4gIGNvbnN0IHJlcXVlc3RlZER1cmF0aW9uID0gZ2V0VGltZVdpbmRvd0R1cmF0aW9uKHJlcXVlc3RlZCk7XG4gIFxuICBpZiAocmVxdWVzdGVkRHVyYXRpb24gPT09IDApIHJldHVybiAwO1xuICBcbiAgcmV0dXJuIE1hdGgubWluKDEsIG92ZXJsYXBEdXJhdGlvbiAvIHJlcXVlc3RlZER1cmF0aW9uKTtcbn1cbiJdfQ==