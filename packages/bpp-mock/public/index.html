<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seller Dashboard | P2P Energy Trading</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0f0a1f;
      --bg-secondary: #1a1230;
      --bg-card: #231940;
      --bg-hover: #2d2050;
      --accent-orange: #f97316;
      --accent-orange-dim: rgba(249, 115, 22, 0.15);
      --accent-purple: #a855f7;
      --accent-purple-dim: rgba(168, 85, 247, 0.15);
      --accent-green: #10b981;
      --accent-green-dim: rgba(16, 185, 129, 0.15);
      --text-primary: #f3f4f6;
      --text-secondary: #9ca3af;
      --text-muted: #6b7280;
      --border: #3d2d5a;
      --seller-gradient: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
      --energy-gradient: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      background-image: 
        radial-gradient(ellipse at 80% 0%, rgba(168, 85, 247, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 20% 100%, rgba(249, 115, 22, 0.06) 0%, transparent 50%);
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 3rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid var(--border);
    }

    .logo { display: flex; align-items: center; gap: 1rem; }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: var(--seller-gradient);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .logo h1 {
      font-size: 1.5rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--accent-orange) 0%, var(--accent-purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .logo span {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-family: 'JetBrains Mono', monospace;
    }

    .tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Outfit', sans-serif;
      font-size: 0.9rem;
    }

    .tab:hover { background: var(--bg-hover); color: var(--text-primary); }
    .tab.active { background: var(--accent-orange-dim); border-color: var(--accent-orange); color: var(--accent-orange); }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .card-title {
      font-size: 1.125rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .card-title-icon {
      width: 32px;
      height: 32px;
      background: var(--accent-purple-dim);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .form-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
    .form-group { display: flex; flex-direction: column; gap: 0.5rem; }
    .form-group.full-width { grid-column: span 2; }

    label { font-size: 0.875rem; color: var(--text-secondary); font-weight: 500; }

    input, select {
      padding: 0.875rem 1rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text-primary);
      font-family: 'Outfit', sans-serif;
      font-size: 1rem;
      transition: all 0.2s;
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--accent-purple);
      box-shadow: 0 0 0 3px var(--accent-purple-dim);
    }

    .btn {
      padding: 1rem 2rem;
      border: none;
      border-radius: 10px;
      font-family: 'Outfit', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-primary { background: var(--seller-gradient); color: white; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(249, 115, 22, 0.3); }
    .btn-secondary { background: var(--bg-hover); color: var(--text-primary); border: 1px solid var(--border); }
    .btn-small { padding: 0.5rem 1rem; font-size: 0.875rem; }
    .btn-danger { background: #dc2626; color: white; }

    .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem; }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.25rem;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      background: linear-gradient(135deg, var(--accent-orange) 0%, var(--accent-purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-label { font-size: 0.875rem; color: var(--text-muted); margin-top: 0.25rem; }

    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--border); }
    th { color: var(--text-muted); font-weight: 500; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px; }
    tr:hover { background: var(--bg-hover); }

    .badge {
      display: inline-flex;
      padding: 0.25rem 0.75rem;
      border-radius: 100px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .badge-solar { background: rgba(251, 191, 36, 0.15); color: #fbbf24; }
    .badge-wind { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
    .badge-active { background: var(--accent-green-dim); color: var(--accent-green); }
    .badge-pending { background: rgba(251, 191, 36, 0.15); color: #fbbf24; }

    .empty-state { text-align: center; padding: 3rem; color: var(--text-muted); }
    .empty-state-icon { font-size: 3rem; margin-bottom: 1rem; opacity: 0.5; }

    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      padding: 1rem 1.5rem;
      background: var(--bg-card);
      border: 1px solid var(--accent-green);
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s;
      z-index: 1000;
    }

    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.error { border-color: #ef4444; }

    .provider-select { margin-bottom: 2rem; display: flex; gap: 1rem; align-items: center; }

    #content { display: none; }

    @media (max-width: 768px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .form-grid { grid-template-columns: 1fr; }
      .form-group.full-width { grid-column: span 1; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">üè™</div>
        <div>
          <h1>Seller Dashboard</h1>
          <span>P2P Energy Trading ‚Ä¢ BPP</span>
        </div>
      </div>
      <div id="providerInfo" style="display: none; color: var(--text-secondary);">
        Provider: <span id="currentProviderName" style="color: var(--accent-purple); font-weight: 600;"></span>
      </div>
    </header>

    <!-- Provider Registration/Selection -->
    <div id="providerSetup" class="card">
      <div class="card-header">
        <div class="card-title">
          <div class="card-title-icon">üë§</div>
          Get Started
        </div>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label>Select Existing Provider</label>
          <select id="existingProvider">
            <option value="">-- Select Provider --</option>
          </select>
        </div>
        <div class="form-group">
          <label>&nbsp;</label>
          <button class="btn btn-secondary" onclick="selectProvider()">Continue</button>
        </div>
        <div class="form-group full-width" style="text-align: center; padding: 1rem 0; color: var(--text-muted);">
          ‚Äî or register as a new provider ‚Äî
        </div>
        <div class="form-group">
          <label>Provider Name</label>
          <input type="text" id="newProviderName" placeholder="e.g., SunPower Farms">
        </div>
        <div class="form-group">
          <label>&nbsp;</label>
          <button class="btn btn-primary" onclick="registerProvider()">Register</button>
        </div>
      </div>
    </div>

    <!-- Main Content (hidden until provider selected) -->
    <div id="content">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="statItems">0</div>
          <div class="stat-label">Energy Listings</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statOffers">0</div>
          <div class="stat-label">Active Offers</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statOrders">0</div>
          <div class="stat-label">Total Orders</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statTrust">0%</div>
          <div class="stat-label">Trust Score</div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="listings" onclick="switchTab('listings')">üì¶ My Listings</button>
        <button class="tab" data-tab="offers" onclick="switchTab('offers')">üí∞ Offers</button>
        <button class="tab" data-tab="orders" onclick="switchTab('orders')">üìã Orders</button>
        <button class="tab" data-tab="add" onclick="switchTab('add')">‚ûï Add New</button>
      </div>

      <!-- Listings Tab -->
      <div id="tab-listings" class="tab-content">
        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <div class="card-title-icon">‚ö°</div>
              My Energy Listings
            </div>
          </div>
          <div id="itemsTable"></div>
        </div>
      </div>

      <!-- Offers Tab -->
      <div id="tab-offers" class="tab-content" style="display: none;">
        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <div class="card-title-icon">üí∞</div>
              My Offers
            </div>
          </div>
          <div id="offersTable"></div>
        </div>
      </div>

      <!-- Orders Tab -->
      <div id="tab-orders" class="tab-content" style="display: none;">
        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <div class="card-title-icon">üìã</div>
              Incoming Orders
            </div>
          </div>
          <div id="ordersTable"></div>
        </div>
      </div>

      <!-- Add New Tab -->
      <div id="tab-add" class="tab-content" style="display: none;">
        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <div class="card-title-icon">üì¶</div>
              Add Energy Listing
            </div>
          </div>
          <form id="addItemForm" class="form-grid">
            <div class="form-group">
              <label>Energy Source</label>
              <select id="itemSourceType" required>
                <option value="SOLAR">‚òÄÔ∏è Solar</option>
                <option value="WIND">üí® Wind</option>
                <option value="HYDRO">üíß Hydro</option>
              </select>
            </div>
            <div class="form-group">
              <label>Available Quantity (kWh)</label>
              <input type="number" id="itemAvailableQty" value="100" min="1" required>
            </div>
            <div class="form-group">
              <label>Meter ID</label>
              <input type="text" id="itemMeterId" placeholder="auto-generated">
            </div>
            <div class="form-group full-width">
              <button type="submit" class="btn btn-primary">‚ûï Add Listing</button>
            </div>
          </form>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <div class="card-title-icon">üí∞</div>
              Add Offer for Item
            </div>
          </div>
          <form id="addOfferForm" class="form-grid">
            <div class="form-group full-width">
              <label>Select Item</label>
              <select id="offerItemId" required>
                <option value="">-- Select Item --</option>
              </select>
            </div>
            <div class="form-group">
              <label>Price ($/kWh)</label>
              <input type="number" id="offerPrice" value="0.10" min="0.01" step="0.01" required>
            </div>
            <div class="form-group">
              <label>Max Quantity (kWh)</label>
              <input type="number" id="offerMaxQty" value="50" min="1" required>
            </div>
            <div class="form-group">
              <label>Time Window Start</label>
              <input type="datetime-local" id="offerStartTime" required>
            </div>
            <div class="form-group">
              <label>Time Window End</label>
              <input type="datetime-local" id="offerEndTime" required>
            </div>
            <div class="form-group full-width">
              <button type="submit" class="btn btn-primary">üí∞ Create Offer</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">
    <span id="toastIcon">‚úì</span>
    <span id="toastMessage"></span>
  </div>

  <script>
    let currentProvider = null;

    // API
    const api = {
      async getProviders() {
        const res = await fetch('/seller/providers');
        return res.json();
      },
      async registerProvider(name) {
        const res = await fetch('/seller/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name })
        });
        return res.json();
      },
      async getProviderDetails(id) {
        const res = await fetch(`/seller/providers/${id}`);
        return res.json();
      },
      async addItem(data) {
        const res = await fetch('/seller/items', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        return res.json();
      },
      async addOffer(data) {
        const res = await fetch('/seller/offers', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        return res.json();
      },
      async getOrders(providerId) {
        const res = await fetch(`/seller/orders?provider_id=${providerId}`);
        return res.json();
      },
      async deleteOffer(id) {
        await fetch(`/seller/offers/${id}`, { method: 'DELETE' });
      }
    };

    // Toast
    function showToast(message, isError = false) {
      const toast = document.getElementById('toast');
      document.getElementById('toastIcon').textContent = isError ? '‚úï' : '‚úì';
      document.getElementById('toastMessage').textContent = message;
      toast.className = 'toast show' + (isError ? ' error' : '');
      setTimeout(() => { toast.className = 'toast'; }, 3000);
    }

    // Load providers
    async function loadProviders() {
      const { providers } = await api.getProviders();
      const select = document.getElementById('existingProvider');
      select.innerHTML = '<option value="">-- Select Provider --</option>';
      providers.forEach(p => {
        select.innerHTML += `<option value="${p.id}">${p.name} (Trust: ${(p.trust_score * 100).toFixed(0)}%)</option>`;
      });
    }

    // Register provider
    async function registerProvider() {
      const name = document.getElementById('newProviderName').value.trim();
      if (!name) return showToast('Enter a provider name', true);
      
      const { provider } = await api.registerProvider(name);
      currentProvider = provider;
      showToast(`Registered as ${provider.name}!`);
      await loadProviders();
      showDashboard();
    }

    // Select provider
    async function selectProvider() {
      const id = document.getElementById('existingProvider').value;
      if (!id) return showToast('Select a provider', true);
      
      const { provider } = await api.getProviderDetails(id);
      currentProvider = provider;
      showDashboard();
    }

    // Show main dashboard
    async function showDashboard() {
      document.getElementById('providerSetup').style.display = 'none';
      document.getElementById('content').style.display = 'block';
      document.getElementById('providerInfo').style.display = 'block';
      document.getElementById('currentProviderName').textContent = currentProvider.name;
      
      await refreshData();
    }

    // Refresh all data
    async function refreshData() {
      const { provider, items, offers } = await api.getProviderDetails(currentProvider.id);
      const { orders } = await api.getOrders(currentProvider.id);
      
      // Update stats
      document.getElementById('statItems').textContent = items.length;
      document.getElementById('statOffers').textContent = offers.length;
      document.getElementById('statOrders').textContent = orders.length;
      document.getElementById('statTrust').textContent = `${(provider.trust_score * 100).toFixed(0)}%`;
      
      // Render items
      renderItems(items);
      renderOffers(offers);
      renderOrders(orders);
      updateItemSelect(items);
    }

    function renderItems(items) {
      const container = document.getElementById('itemsTable');
      if (items.length === 0) {
        container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì¶</div><p>No energy listings yet. Add one from the "Add New" tab.</p></div>';
        return;
      }
      container.innerHTML = `
        <table>
          <thead><tr><th>ID</th><th>Source</th><th>Mode</th><th>Available</th></tr></thead>
          <tbody>
            ${items.map(i => `
              <tr>
                <td><code>${i.id}</code></td>
                <td><span class="badge badge-${i.source_type.toLowerCase()}">${i.source_type}</span></td>
                <td>${i.delivery_mode}</td>
                <td>${i.available_qty} kWh</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }

    function renderOffers(offers) {
      const container = document.getElementById('offersTable');
      if (offers.length === 0) {
        container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üí∞</div><p>No offers yet. Create one from the "Add New" tab.</p></div>';
        return;
      }
      container.innerHTML = `
        <table>
          <thead><tr><th>ID</th><th>Item</th><th>Price</th><th>Total Blocks</th><th>Available</th><th>Sold</th><th>Time Window</th><th></th></tr></thead>
          <tbody>
            ${offers.map(o => {
              const stats = o.blockStats || { total: o.maxQuantity, available: 0, sold: 0, reserved: 0 };
              const availableColor = stats.available > 0 ? 'var(--accent-green)' : 'var(--text-muted)';
              return `
              <tr>
                <td><code>${o.id}</code></td>
                <td><code>${o.item_id}</code></td>
                <td style="color: var(--accent-green); font-family: 'JetBrains Mono';">$${o.price.value.toFixed(2)}/kWh</td>
                <td style="font-weight: 600;">${stats.total} blocks</td>
                <td style="color: ${availableColor}; font-weight: 600;">${stats.available} blocks</td>
                <td style="color: var(--accent-orange);">${stats.sold} blocks</td>
                <td style="font-size: 0.8rem;">${new Date(o.timeWindow.startTime).toLocaleString()} - ${new Date(o.timeWindow.endTime).toLocaleString()}</td>
                <td><button class="btn btn-small btn-danger" onclick="removeOffer('${o.id}')">Delete</button></td>
              </tr>
            `;
            }).join('')}
          </tbody>
        </table>
      `;
    }

    function renderOrders(orders) {
      const container = document.getElementById('ordersTable');
      if (orders.length === 0) {
        container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üìã</div><p>No orders received yet.</p></div>';
        return;
      }
      container.innerHTML = `
        <table>
          <thead><tr><th>Order ID</th><th>Status</th><th>Sold Qty</th><th>Price (Sold)</th><th>Remaining</th><th>Created</th></tr></thead>
          <tbody>
            ${orders.map(o => {
              // Use actual sold quantity from blocks (itemInfo.sold_quantity) if available, otherwise fallback to quote
              const soldQty = (o.itemInfo && o.itemInfo.sold_quantity !== undefined) 
                ? o.itemInfo.sold_quantity 
                : (o.quote?.totalQuantity || 0);
              
              // Calculate price for sold quantity (price per unit * sold quantity)
              const pricePerUnit = o.items && o.items.length > 0 && o.items[0].quantity > 0
                ? (o.items[0].price.value / o.items[0].quantity)
                : (o.quote?.price?.value || 0) / (o.quote?.totalQuantity || 1);
              const priceForSold = pricePerUnit * soldQty;
              
              // Handle remaining quantity - check if itemInfo exists
              let remaining = 'N/A';
              if (o.itemInfo && o.itemInfo.remaining_quantity !== null && o.itemInfo.remaining_quantity !== undefined) {
                remaining = o.itemInfo.remaining_quantity;
              }
              
              const remainingDisplay = remaining !== 'N/A' ? `${remaining} kWh` : 'N/A';
              const remainingColor = remaining !== 'N/A' && remaining < 10 ? 'var(--accent-orange)' : 'var(--text-secondary)';
              
              return `
              <tr>
                <td><code>${o.id.substring(0, 8)}...</code></td>
                <td><span class="badge badge-${o.status.toLowerCase()}">${o.status}</span></td>
                <td style="font-weight: 600;">${soldQty} kWh</td>
                <td style="color: var(--accent-green); font-family: 'JetBrains Mono'; font-weight: 600;">$${priceForSold.toFixed(2)}</td>
                <td style="color: ${remainingColor}; font-size: 0.9rem;">${remainingDisplay}</td>
                <td style="font-size: 0.8rem;">${new Date(o.created_at).toLocaleString()}</td>
              </tr>
            `;
            }).join('')}
          </tbody>
        </table>
      `;
    }

    function updateItemSelect(items) {
      const select = document.getElementById('offerItemId');
      select.innerHTML = '<option value="">-- Select Item --</option>';
      items.forEach(i => {
        select.innerHTML += `<option value="${i.id}">${i.id} (${i.source_type}, ${i.available_qty} kWh)</option>`;
      });
    }

    // Tab switching
    function switchTab(tabId) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
      document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
      document.getElementById(`tab-${tabId}`).style.display = 'block';
    }

    // Add item
    document.getElementById('addItemForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const data = {
        provider_id: currentProvider.id,
        source_type: document.getElementById('itemSourceType').value,
        delivery_mode: 'SCHEDULED', // Always scheduled for P2P energy trading
        available_qty: parseInt(document.getElementById('itemAvailableQty').value),
        meter_id: document.getElementById('itemMeterId').value || undefined,
      };
      
      const result = await api.addItem(data);
      if (result.status === 'ok') {
        showToast('Energy listing added!');
        await refreshData();
        switchTab('listings');
      } else {
        showToast(result.error || 'Failed to add item', true);
      }
    });

    // Add offer
    document.getElementById('addOfferForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const data = {
        provider_id: currentProvider.id,
        item_id: document.getElementById('offerItemId').value,
        price_per_kwh: parseFloat(document.getElementById('offerPrice').value),
        currency: 'INR',
        max_qty: parseInt(document.getElementById('offerMaxQty').value),
        time_window: {
          startTime: new Date(document.getElementById('offerStartTime').value).toISOString(),
          endTime: new Date(document.getElementById('offerEndTime').value).toISOString(),
        }
      };
      
      const result = await api.addOffer(data);
      if (result.status === 'ok') {
        showToast('Offer created!');
        await refreshData();
        switchTab('offers');
      } else {
        showToast(result.error || 'Failed to create offer', true);
      }
    });

    // Delete offer
    async function removeOffer(id) {
      if (!confirm('Delete this offer?')) return;
      await api.deleteOffer(id);
      showToast('Offer deleted');
      await refreshData();
    }

    // Set default datetime
    function setDefaultDates() {
      const now = new Date();
      const tomorrow = new Date(now.getTime() + 86400000);
      const format = d => d.toISOString().slice(0, 16);
      document.getElementById('offerStartTime').value = format(new Date(tomorrow.setHours(8, 0)));
      document.getElementById('offerEndTime').value = format(new Date(tomorrow.setHours(18, 0)));
    }

    // Init
    loadProviders();
    setDefaultDates();
  </script>
</body>
</html>
